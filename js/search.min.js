var lunrIndex,$results,pagesIndex,tinySegmenter;function initLunr(){return tinySegmenter=new lunr.TinySegmenter,new Promise((b,c)=>{var a=new XMLHttpRequest;a.open("GET","index.json",!0),a.onload=function(){if(a.status>=200&&a.status<400)pagesIndex=JSON.parse(a.responseText),console.log("index:",pagesIndex),lunrIndex=lunr(function(){this.use(lunr.ja),this.field("title",{boost:10}),this.field("categories"),this.field("tags"),this.field("description"),this.ref("href");for(var a=0;a<pagesIndex.length;++a)this.add(pagesIndex[a]);b()});else{var d=textStatus+", "+error;console.error("Error getting Hugo index flie:",d),c(d)}},a.send()})}function initUI(){$results=document.getElementById("results"),$search=document.getElementById("search"),$search.onkeyup=function(){for(var a,b;$results.firstChild;)$results.removeChild($results.firstChild);a=$search.value,a=decodeURI(a),b=search(a),renderResults(b)}}function search(a){var b=tinySegmenter.segment(a);return b=b.map(function(a){return a=a.trim(),a.length&&(a=`+*${a}*`),a}),a=b.join(" ").replace(/\s+/g," ").trim(),console.log("search:",a),lunrIndex.search(a).map(function(a){return pagesIndex.filter(function(b){return b.href===a.ref})[0]})}function renderResults(a){if(!a.length)return;$results=document.getElementById("results"),a.slice(0,10).forEach(function(a){var b=document.createElement("div"),c="",d,e;a.categories&&(c=`
                <a class="partials__articleCard__detail__category" href="/categories/${a.categories}">
                    <svg class="fa-sm"><use xlink:href="/fontawesome/sprites/solid.svg#folder"></use></svg>&nbsp;${a.categories}
                </a>
            `),d="",a.tags&&(e=a.tags.map(function(a){return`
                    <li class="partials__tagList__item">
                        <a href="/tags/${a}" class="partials__tagList__itemLink">
                            <svg class="fa-sm partials__tagList__itemIcon"><use xlink:href="/fontawesome/sprites/solid.svg#tag"></use></svg>${a}
                        </a>
                    </li>
                `}),d=`
                <ul class="partials__tagList">
                    ${e.join("")}
                </ul>
            `),b.innerHTML=`
            <article class="partials__articleCard">
                <div class="partials__articleCard__inner">
                    <a href="${a.href}" class="partials__articleCard__link"></a>
                    <img src='${a.thumbnail}' alt="${a.title}" loading="lazy" class="partials__articleCard__thumbnail">
                    <h4 class="partials__articleCard__title">
                        ${a.title}
                    </h4>
                    <div class="partials__articleCard__detail">
                        ${c}
                        <div class="partials__articleCard__detail__center"></div>
                        <div class="partials__articleCard__detail__date">
                            <svg class="fa-sm"><use xlink:href="/fontawesome/sprites/solid.svg#clock"></use></svg>&nbsp;${a.lastmod}
                        </div>
                    </div>
                    ${d}
                    <div class="partials__articleCard__description">
                        ${a.summary}
                    </div>
                </div>
            </article>
        `,$results.appendChild(b)})}initLunr().then(function(){var a=getQuery().query||"",b;a=decodeURI(a),b=search(a),renderResults(b),a.length&&(document.getElementById("list-title").innerText=`「${a}」を検索`)}),document.addEventListener("DOMContentLoaded",function(){});function getQuery(){var a=window.location.search,b;return a=a.slice(1),b={},a.split("&").forEach(function(c){const a=c.split("=");b[a[0]]=a[1]}),b}